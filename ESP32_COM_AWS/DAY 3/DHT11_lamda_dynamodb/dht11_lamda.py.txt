import boto3

def lambda_handler(event, context):
    client = boto3.client('dynamodb')

    # Extract values safely using .get()
    temperature = event.get("temperature")
    humidity = event.get("humidity")
    timestamp = event.get("timestamp")

    # Store in DynamoDB
    response = client.put_item(
        TableName='dht11',
        Item={
            'temperature': {'N': str(temperature)},  
            'humidity': {'N': str(humidity)},       
            'timestamp': {'S': str(timestamp)} 
        }
    )

    return 0